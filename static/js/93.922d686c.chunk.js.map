{"version":3,"file":"static/js/93.922d686c.chunk.js","mappings":"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","sources":["utils/sanitize.js","components/ThemeToggle.js","pages/LoginPage.js","utils/validation.js"],"sourcesContent":["import DOMPurify from 'dompurify';\n\n/**\n * Sanitizes HTML content to prevent XSS attacks\n * @param {string} dirty - Potentially unsafe HTML string\n * @param {object} config - DOMPurify configuration options\n * @returns {string} - Sanitized HTML string\n */\nexport const sanitizeHTML = (dirty, config = {}) => {\n  return DOMPurify.sanitize(dirty, {\n    ALLOWED_TAGS: ['b', 'i', 'em', 'strong', 'a', 'p', 'br'],\n    ALLOWED_ATTR: ['href', 'title'],\n    ...config\n  });\n};\n\n/**\n * Sanitizes user input text (strips all HTML)\n * @param {string} input - User input string\n * @returns {string} - Plain text string\n */\nexport const sanitizeText = (input) => {\n  if (!input) return '';\n  return DOMPurify.sanitize(input, { ALLOWED_TAGS: [] });\n};\n\n/**\n * Escapes special characters in a string for safe display\n * @param {string} str - Input string\n * @returns {string} - Escaped string\n */\nexport const escapeHTML = (str) => {\n  if (!str) return '';\n  const div = document.createElement('div');\n  div.textContent = str;\n  return div.innerHTML;\n};\n\n/**\n * Sanitizes chat message content\n * @param {string} message - Chat message\n * @returns {string} - Sanitized message\n */\nexport const sanitizeChatMessage = (message) => {\n  return sanitizeText(message).trim();\n};\n\n/**\n * Validates and sanitizes URL\n * @param {string} url - URL to validate\n * @returns {string|null} - Sanitized URL or null if invalid\n */\nexport const sanitizeURL = (url) => {\n  try {\n    const urlObj = new URL(url);\n    // Only allow http and https protocols\n    if (!['http:', 'https:'].includes(urlObj.protocol)) {\n      return null;\n    }\n    return urlObj.href;\n  } catch {\n    return null;\n  }\n};\n\nexport default {\n  sanitizeHTML,\n  sanitizeText,\n  escapeHTML,\n  sanitizeChatMessage,\n  sanitizeURL\n};\n","import React, { useCallback } from 'react';\nimport { useTheme } from '../contexts/ThemeContext';\n\nconst ThemeToggle = ({ showLabel = false }) => {\n  const { isDark, toggleTheme } = useTheme();\n\n  const handleToggle = useCallback(() => {\n    toggleTheme();\n  }, [toggleTheme]);\n\n  const handleKeyDown = useCallback((event) => {\n    if (event.key === 'Enter' || event.key === ' ') {\n      event.preventDefault();\n      handleToggle();\n    }\n  }, [handleToggle]);\n\n  const labelText = isDark ? 'Switch to Light Mode' : 'Switch to Dark Mode';\n\n  return (\n    <div className=\"flex items-center\">\n      {showLabel && (\n        <span className=\"mr-2 text-sm text-custom-text\">\n          {labelText}\n        </span>\n      )}\n      <div className=\"relative inline-block\">\n        <input\n          type=\"checkbox\"\n          id=\"theme-toggle\"\n          className=\"sr-only\"\n          checked={isDark}\n          onChange={handleToggle}\n          onKeyDown={handleKeyDown}\n          aria-label={labelText}\n        />\n        <label\n          htmlFor=\"theme-toggle\"\n          className={`theme-toggle ${isDark ? 'checked' : ''}`}\n          role=\"switch\"\n          aria-checked={isDark}\n        >\n          <div className=\"theme-toggle-knob\" />\n        </label>\n      </div>\n    </div>\n  );\n};\n\nexport default ThemeToggle;\n","import React, { useState, useEffect } from 'react';\nimport { Link, useNavigate } from 'react-router-dom';\nimport { useAuth } from '../contexts/AuthContext';\nimport { useNotification } from '../contexts/NotificationContext';\nimport ThemeToggle from '../components/ThemeToggle';\nimport LoadingSpinner from '../components/LoadingSpinner';\nimport { isValidEmail, isValidPhone, checkRateLimit } from '../utils/validation';\nimport { sanitizeText } from '../utils/sanitize';\n\nconst LoginPage = () => {\n  const navigate = useNavigate();\n  const { login, loading, isAuthenticated } = useAuth();\n  const { showSuccess, showError } = useNotification();\n  const [formData, setFormData] = useState({\n    email: '',\n    phone: '',\n    enrollment: '',\n    password: ''\n  });\n  const [errors, setErrors] = useState({});\n  const [error, setError] = useState('');\n  const [attempts, setAttempts] = useState(0);\n\n  useEffect(() => {\n    if (isAuthenticated) {\n      navigate('/');\n    }\n  }, [isAuthenticated, navigate]);\n\n  const handleChange = (e) => {\n    const { name, value } = e.target;\n    const sanitizedValue = name === 'password' ? value : sanitizeText(value);\n    \n    setFormData({\n      ...formData,\n      [name]: sanitizedValue\n    });\n    \n    // Clear field-specific error\n    if (errors[name]) {\n      setErrors({ ...errors, [name]: '' });\n    }\n    if (error) setError('');\n  };\n\n  const validateForm = () => {\n    const newErrors = {};\n    \n    if (!formData.email || !isValidEmail(formData.email)) {\n      newErrors.email = 'Please enter a valid email address';\n    }\n    \n    if (!formData.phone || !isValidPhone(formData.phone)) {\n      newErrors.phone = 'Please enter a valid phone number';\n    }\n    \n    if (!formData.enrollment || formData.enrollment.trim().length < 3) {\n      newErrors.enrollment = 'Please enter a valid enrollment number';\n    }\n    \n    if (!formData.password || formData.password.length < 6) {\n      newErrors.password = 'Password must be at least 6 characters';\n    }\n    \n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    setError('');\n    \n    // Rate limiting check\n    if (!checkRateLimit('login', 5, 300000)) { // 5 attempts per 5 minutes\n      const errorMsg = 'Too many login attempts. Please try again in 5 minutes.';\n      setError(errorMsg);\n      showError(errorMsg);\n      return;\n    }\n    \n    // Validate form\n    if (!validateForm()) {\n      showError('Please fix the errors in the form');\n      return;\n    }\n    \n    setAttempts(prev => prev + 1);\n    \n    const result = await login(formData);\n    if (result.success) {\n      showSuccess('ðŸŽ‰ Welcome back to Campus Connect!', {\n        duration: 3000\n      });\n      // Clear rate limit on successful login\n      localStorage.removeItem('rateLimit_login');\n      setTimeout(() => {\n        navigate('/');\n      }, 1500);\n    } else {\n      const errorMsg = result.error || 'Login failed. Please check your credentials.';\n      setError(errorMsg);\n      showError(errorMsg);\n    }\n  };\n\n  return (\n    <div className=\"bg-custom-bg text-custom-text min-h-screen flex items-center justify-center transition-theme\">\n      <a href=\"#main-content\" className=\"skip-to-content\">\n        Skip to main content\n      </a>\n      <main id=\"main-content\" className=\"bg-custom-bg-2 p-8 rounded-lg shadow-md w-full max-w-md transition-theme\">\n        <h1 className=\"text-2xl font-bold text-center mb-6\">Sign In to Campus Connect</h1>\n\n        <div className=\"flex items-center justify-center mb-4\">\n          <div className=\"flex gap-3 items-center\">\n            <ThemeToggle showLabel={true} />\n          </div>\n        </div>\n\n        {error && (\n          <div \n            className=\"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded\" \n            role=\"alert\"\n            aria-live=\"polite\"\n          >\n            <strong className=\"font-bold\">Error: </strong>\n            <span>{error}</span>\n          </div>\n        )}\n\n        <form onSubmit={handleSubmit} noValidate aria-label=\"Login form\">\n          <div className=\"mb-4\">\n            <label htmlFor=\"email\" className=\"block text-custom-text-secondary text-sm font-bold mb-2 required\">\n              Email ID (College Provided)\n            </label>\n            <input\n              type=\"email\"\n              id=\"email\"\n              name=\"email\"\n              value={formData.email}\n              onChange={handleChange}\n              className={`shadow appearance-none border rounded w-full py-2 px-3 text-custom-text leading-tight focus:outline-none focus:ring-2 focus:ring-custom-teal bg-input ${\n                errors.email ? 'border-red-500' : 'border-custom-border'\n              }`}\n              placeholder=\"yourname@university.edu\"\n              required\n              disabled={loading}\n              aria-required=\"true\"\n              aria-invalid={errors.email ? 'true' : 'false'}\n              aria-describedby={errors.email ? 'email-error' : undefined}\n              autoComplete=\"email\"\n            />\n            {errors.email && (\n              <p id=\"email-error\" className=\"text-red-500 text-xs mt-1\" role=\"alert\">\n                {errors.email}\n              </p>\n            )}\n          </div>\n          \n          <div className=\"mb-4\">\n            <label htmlFor=\"phone\" className=\"block text-custom-text-secondary text-sm font-bold mb-2 required\">\n              Phone Number\n            </label>\n            <input\n              type=\"tel\"\n              id=\"phone\"\n              name=\"phone\"\n              value={formData.phone}\n              onChange={handleChange}\n              className={`shadow appearance-none border rounded w-full py-2 px-3 text-custom-text leading-tight focus:outline-none focus:ring-2 focus:ring-custom-teal bg-input ${\n                errors.phone ? 'border-red-500' : 'border-custom-border'\n              }`}\n              placeholder=\"+1 (555) 123-4567\"\n              required\n              disabled={loading}\n              aria-required=\"true\"\n              aria-invalid={errors.phone ? 'true' : 'false'}\n              aria-describedby={errors.phone ? 'phone-error' : undefined}\n              autoComplete=\"tel\"\n            />\n            {errors.phone && (\n              <p id=\"phone-error\" className=\"text-red-500 text-xs mt-1\" role=\"alert\">\n                {errors.phone}\n              </p>\n            )}\n          </div>\n          \n          <div className=\"mb-4\">\n            <label htmlFor=\"enrollment\" className=\"block text-custom-text-secondary text-sm font-bold mb-2 required\">\n              Enrollment Number\n            </label>\n            <input\n              type=\"text\"\n              id=\"enrollment\"\n              name=\"enrollment\"\n              value={formData.enrollment}\n              onChange={handleChange}\n              className={`shadow appearance-none border rounded w-full py-2 px-3 text-custom-text leading-tight focus:outline-none focus:ring-2 focus:ring-custom-teal bg-input ${\n                errors.enrollment ? 'border-red-500' : 'border-custom-border'\n              }`}\n              placeholder=\"ENR123456\"\n              required\n              disabled={loading}\n              aria-required=\"true\"\n              aria-invalid={errors.enrollment ? 'true' : 'false'}\n              aria-describedby={errors.enrollment ? 'enrollment-error' : undefined}\n              autoComplete=\"off\"\n            />\n            {errors.enrollment && (\n              <p id=\"enrollment-error\" className=\"text-red-500 text-xs mt-1\" role=\"alert\">\n                {errors.enrollment}\n              </p>\n            )}\n          </div>\n          \n          <div className=\"mb-6\">\n            <label htmlFor=\"password\" className=\"block text-custom-text-secondary text-sm font-bold mb-2 required\">\n              Password\n            </label>\n            <input\n              type=\"password\"\n              id=\"password\"\n              name=\"password\"\n              value={formData.password}\n              onChange={handleChange}\n              className={`shadow appearance-none border rounded w-full py-2 px-3 text-custom-text leading-tight focus:outline-none focus:ring-2 focus:ring-custom-teal bg-input ${\n                errors.password ? 'border-red-500' : 'border-custom-border'\n              }`}\n              placeholder=\"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢\"\n              required\n              disabled={loading}\n              aria-required=\"true\"\n              aria-invalid={errors.password ? 'true' : 'false'}\n              aria-describedby={errors.password ? 'password-error' : undefined}\n              autoComplete=\"current-password\"\n              minLength=\"6\"\n            />\n            {errors.password && (\n              <p id=\"password-error\" className=\"text-red-500 text-xs mt-1\" role=\"alert\">\n                {errors.password}\n              </p>\n            )}\n          </div>\n          \n          <div className=\"flex items-center justify-between\">\n            <button\n              className=\"bg-custom-blue hover:bg-blue-700 active:bg-blue-800 text-white font-bold py-2 px-4 rounded focus:outline-none focus:ring-2 focus:ring-custom-blue focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2 transition-colors\"\n              type=\"submit\"\n              disabled={loading}\n              aria-busy={loading ? 'true' : 'false'}\n            >\n              {loading && <LoadingSpinner size=\"small\" />}\n              <span>{loading ? 'Signing in...' : 'Sign In'}</span>\n            </button>\n            <Link\n              to=\"#\"\n              className=\"inline-block align-baseline font-bold text-sm text-custom-teal hover:text-blue-800 focus:outline-none focus:ring-2 focus:ring-custom-teal rounded px-1\"\n              aria-label=\"Reset your forgotten password\"\n            >\n              Forgot password?\n            </Link>\n          </div>\n        </form>\n        \n        <div className=\"mt-4 text-center\">\n          <p className=\"text-custom-text-secondary text-sm\">\n            Don't have an account?{' '}\n            <Link \n              to=\"/register\" \n              className=\"text-custom-teal hover:text-blue-800 font-bold focus:outline-none focus:ring-2 focus:ring-custom-teal rounded px-1\"\n              aria-label=\"Create a new Campus Connect account\"\n            >\n              Register here\n            </Link>\n          </p>\n        </div>\n      </main>\n    </div>\n  );\n};\n\nexport default LoginPage;\n","import validator from 'validator';\n\n/**\n * Validates email address\n * @param {string} email - Email to validate\n * @returns {boolean} - True if valid\n */\nexport const isValidEmail = (email) => {\n  return validator.isEmail(email || '');\n};\n\n/**\n * Validates password strength\n * @param {string} password - Password to validate\n * @returns {object} - { isValid, errors }\n */\nexport const validatePassword = (password) => {\n  const errors = [];\n  \n  if (!password || password.length < 8) {\n    errors.push('Password must be at least 8 characters long');\n  }\n  if (!/[A-Z]/.test(password)) {\n    errors.push('Password must contain at least one uppercase letter');\n  }\n  if (!/[a-z]/.test(password)) {\n    errors.push('Password must contain at least one lowercase letter');\n  }\n  if (!/[0-9]/.test(password)) {\n    errors.push('Password must contain at least one number');\n  }\n  if (!/[!@#$%^&*(),.?\":{}|<>]/.test(password)) {\n    errors.push('Password must contain at least one special character');\n  }\n\n  return {\n    isValid: errors.length === 0,\n    errors\n  };\n};\n\n/**\n * Validates URL\n * @param {string} url - URL to validate\n * @returns {boolean} - True if valid\n */\nexport const isValidURL = (url) => {\n  return validator.isURL(url || '', {\n    protocols: ['http', 'https'],\n    require_protocol: true\n  });\n};\n\n/**\n * Validates phone number\n * @param {string} phone - Phone number to validate\n * @returns {boolean} - True if valid\n */\nexport const isValidPhone = (phone) => {\n  return validator.isMobilePhone(phone || '', 'any', { strictMode: false });\n};\n\n/**\n * Sanitizes and validates text input\n * @param {string} input - Input to validate\n * @param {object} options - Validation options\n * @returns {object} - { isValid, sanitized, errors }\n */\nexport const validateTextInput = (input, options = {}) => {\n  const {\n    minLength = 1,\n    maxLength = 1000,\n    required = false,\n    alphanumeric = false\n  } = options;\n\n  const errors = [];\n  const trimmed = (input || '').trim();\n\n  if (required && !trimmed) {\n    errors.push('This field is required');\n  }\n\n  if (trimmed && trimmed.length < minLength) {\n    errors.push(`Must be at least ${minLength} characters`);\n  }\n\n  if (trimmed && trimmed.length > maxLength) {\n    errors.push(`Must be less than ${maxLength} characters`);\n  }\n\n  if (alphanumeric && trimmed && !validator.isAlphanumeric(trimmed, 'en-US', { ignore: ' ' })) {\n    errors.push('Only letters and numbers are allowed');\n  }\n\n  return {\n    isValid: errors.length === 0,\n    sanitized: trimmed,\n    errors\n  };\n};\n\n/**\n * Validates file upload\n * @param {File} file - File to validate\n * @param {object} options - Validation options\n * @returns {object} - { isValid, errors }\n */\nexport const validateFile = (file, options = {}) => {\n  const {\n    maxSize = 5 * 1024 * 1024, // 5MB default\n    allowedTypes = ['image/jpeg', 'image/png', 'image/gif', 'image/webp']\n  } = options;\n\n  const errors = [];\n\n  if (!file) {\n    errors.push('No file provided');\n    return { isValid: false, errors };\n  }\n\n  if (file.size > maxSize) {\n    errors.push(`File size must be less than ${maxSize / (1024 * 1024)}MB`);\n  }\n\n  if (!allowedTypes.includes(file.type)) {\n    errors.push(`File type must be one of: ${allowedTypes.join(', ')}`);\n  }\n\n  return {\n    isValid: errors.length === 0,\n    errors\n  };\n};\n\n/**\n * Rate limiting check (client-side)\n * @param {string} key - Unique key for the action\n * @param {number} maxAttempts - Maximum attempts allowed\n * @param {number} windowMs - Time window in milliseconds\n * @returns {boolean} - True if action is allowed\n */\nexport const checkRateLimit = (key, maxAttempts = 5, windowMs = 60000) => {\n  const now = Date.now();\n  const attempts = JSON.parse(localStorage.getItem(`rateLimit_${key}`) || '[]');\n  \n  // Remove old attempts outside the window\n  const recentAttempts = attempts.filter(time => now - time < windowMs);\n  \n  if (recentAttempts.length >= maxAttempts) {\n    return false;\n  }\n  \n  recentAttempts.push(now);\n  localStorage.setItem(`rateLimit_${key}`, JSON.stringify(recentAttempts));\n  \n  return true;\n};\n\nexport default {\n  isValidEmail,\n  validatePassword,\n  isValidURL,\n  isValidPhone,\n  validateTextInput,\n  validateFile,\n  checkRateLimit\n};\n"],"names":["sanitizeText","input","DOMPurify","sanitize","ALLOWED_TAGS","sanitizeChatMessage","message","trim","_ref","showLabel","isDark","toggleTheme","useTheme","handleToggle","useCallback","handleKeyDown","event","key","preventDefault","labelText","_jsxs","className","children","_jsx","type","id","checked","onChange","onKeyDown","htmlFor","concat","role","LoginPage","navigate","useNavigate","login","loading","isAuthenticated","useAuth","showSuccess","showError","useNotification","formData","setFormData","useState","email","phone","enrollment","password","errors","setErrors","error","setError","attempts","setAttempts","useEffect","handleChange","e","name","value","target","sanitizedValue","_objectSpread","href","ThemeToggle","onSubmit","async","checkRateLimit","errorMsg","validateForm","newErrors","isValidEmail","isValidPhone","length","Object","keys","prev","result","success","duration","localStorage","removeItem","setTimeout","noValidate","placeholder","required","disabled","undefined","autoComplete","minLength","LoadingSpinner","size","Link","to","validator","validatePassword","push","test","isValid","strictMode","maxAttempts","arguments","windowMs","now","Date","recentAttempts","JSON","parse","getItem","filter","time","setItem","stringify"],"sourceRoot":""}